.code

getTeb proc
	mov rax, gs:[30h]		; In 64-bit systems, TEB always at gs:[30h] location
	ret
getTeb endp

getPeb proc
	mov rax, gs:[60h]		; In 64-bit systems, PEB always at gs:[60h] locatio
	ret
getPeb endp

checkDebugged proc
	xor rax, rax
	call getPeb				; location of PEB is moved to rax 
	mov rax, [rax+2h]		; Variable that holds whether the debugger is running lies at [PEB + 0x2]  
	ret
checkDebugged endp

end