#include "Encryptshell.h";

unsigned char* addPadding(unsigned char *shl, int shlL) {
	
	int shlLen = shlL;
	int round = shlLen + 16 - (shlLen % 16);
	unsigned char nop[] = "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90";
	unsigned char *paddedShl = malloc(round + 1);

	if (shlLen % 16 == 0) {
		memcpy(paddedShl, shl, shlLen-1);
		memcpy(paddedShl + shlLen-1, nop, 17);
		return paddedShl;
	}
	else {
		memcpy(paddedShl, shl, shlLen - 1);

		for (int i = 0; i < (round - shlLen)+1; i++) {
			memcpy(paddedShl + shlLen - 1 + i, nop, 1);
		}

		return paddedShl;
	}

}

unsigned char* genRand(int size) {
	unsigned char* randArr = malloc(size * sizeof(unsigned char));

	for (int i = 0; i < size; i++) {
		randArr[i] = (rand() & 0xff);
	}

	return randArr;
}